<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

  <meta name="viewport" content="initial-scale=1.0, user-scalable=no"><!-- Responsive map -->

  <title>cuppaCoffee</title>
 <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
  <![endif]-->
  <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyCg_O_lXUOWrL7NJbzGbpGg-d-YWb8hIAc"></script>
  <script src="//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js"></script>
  <script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->


</head>
<body id="bootstrap-overrides">
  <%= render 'shared/navigation' %><!-- /.navbar -->

  <!-- Alert for user registration/login status-->
  <% if notice %>
  <p class="alert alert-success"><%= notice %></p>
  <% end %>
  <% if alert %>
  <p class="alert alert-danger"><%= alert %></p>
  <% end %>

  <!-- Main jumbotron for a primary marketing message or call to action -->
  <div id="main-container" class="jumbotron">
    <div class="container">
      <h1>cuppa<span class="pink">Coffee</span></h1>
      <p>Count your cups!</p>
    </div>
  </div>

<div class="container-fluid">
    <div class="row">
      <div class="col-xs-12">
        <% flash.each do |name, msg| -%>
        <%= content_tag :div, msg, class: "alert alert-#{name}" %>
        <% end -%>
      </div>
    </div>

    <div id="about" class="row">
      <!-- sidebar content -->
      <div id="sidebar" class="col-md-3 col-md-push-9">
        <h1>About cuppaCoffee</h1>
        <p>If you're anything like me, our mornings haven't begun until the that first cup of coffee. I drink coffee almost, if not almost always, everyday and I'm PROUD OF IT! To prove it to the rest of the world, I've created this simple coffee app to track all the delicious coffee I've consumed on a daily basis. At the end of the month, I can brag about all the deliciousness I've consumed!</p>
        <p>Do you love coffee as much as I do? If so, create an cuppaCoffee account today to get started!</p>
      </div><!-- /#sidebar -->

      <!-- main content -->
      <div id="content" class="col-md-9 col-md-pull-3">
        <%= yield %>

        <br><br>

        <div
          class="fb-like"
          data-share="true"
          data-width="450"
          data-show-faces="true">
        </div>

      </div><!-- /#content -->
    </div>

    <div class="row">
      <h1>cuppaCoffee drinkers</h1>
      <% @users = User.all %>
      <% @hash = Gmaps4rails.build_markers(@users) do |user, marker| %>
        <% marker.lat user.latitude %>
        <% marker.lng user.longitude %>
      <% end %>

      <div style='width: 800px;'>
        <div id="map_canvas" style='width: 800px; height: 400px;'></div>
      </div>
    </div>

    <hr>

    <div class="row">
      <div class="col-md-12">
      <% if user_signed_in? %>
      Logged in as <strong><%= current_user.email %></strong>.
      <%= link_to "Settings", edit_user_path(current_user) %> |
      <%= link_to "Account", edit_user_registration_path %> |
      <%= link_to "Logout", destroy_user_session_path, method: :delete %> |
      <!--       <%# else %>
      <%# link_to "Sign up", new_user_registration_path %> |
      <%# link_to "Login", new_user_session_path %> | -->
      <% end %>
      <%= @hash.to_json %>
      </div>
    </div>
  </div><!-- /#main-container -->

<script type="text/javascript">
  handler = Gmaps.build('Google');
  handler.buildMap({ provider: {}, internal: {id: 'map_canvas'}}, function(){
    markers = handler.addMarkers(<%=raw @hash.to_json %>);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
  });
</script>

<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '1672686636326098',
      xfbml      : true,
      version    : 'v2.5'
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>

</body>
</html>
